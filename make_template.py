import pandas as pd

# 1. [시트1] 계정 과목 마스터 (Account Master)
# - 결산서(대차대조표, 수지결산서)의 뼈대가 되는 항목들입니다.
# - 분석해주신 파일(대차대조표, 지출명세서 등)에 있는 항목을 미리 채웠습니다.
df_accounts = pd.DataFrame([
    # --- 자산 (대차대조표) ---
    {"구분(대분류)": "유동자산", "계정명": "현금", "성격": "ASSET", "결산서위치": "당좌자산", "비고": ""},
    {"구분(대분류)": "유동자산", "계정명": "보통예금", "성격": "ASSET", "결산서위치": "당좌자산", "비고": "기업은행 등"},
    {"구분(대분류)": "유동자산", "계정명": "단기대여금", "성격": "ASSET", "결산서위치": "당좌자산", "비고": ""},
    {"구분(대분류)": "비유동자산", "계정명": "임차보증금", "성격": "ASSET", "결산서위치": "투자자산", "비고": "사무실 보증금"},
    {"구분(대분류)": "비유동자산", "계정명": "비품", "성격": "ASSET", "결산서위치": "유형자산", "비고": "노트북, 가구 등"},
    {"구분(대분류)": "비유동자산", "계정명": "소프트웨어", "성격": "ASSET", "결산서위치": "무형자산", "비고": "QVAN 개발비 등"},
    
    # --- 부채 (대차대조표) ---
    {"구분(대분류)": "유동부채", "계정명": "예수금", "성격": "LIABILITY", "결산서위치": "유동부채", "비고": "4대보험/세금 원천징수분"},
    {"구분(대분류)": "유동부채", "계정명": "미지급금", "성격": "LIABILITY", "결산서위치": "유동부채", "비고": "카드결제 예정액 등"},
    {"구분(대분류)": "비유동부채", "계정명": "퇴직급여충당금", "성격": "LIABILITY", "결산서위치": "고정부채", "비고": ""},

    # --- 수입 (수지결산서) ---
    {"구분(대분류)": "협회비수입", "계정명": "일반회비", "성격": "INCOME", "결산서위치": "협회비수입", "비고": "회원사 연회비"},
    {"구분(대분류)": "협회비수입", "계정명": "특별회비", "성격": "INCOME", "결산서위치": "협회비수입", "비고": ""},
    {"구분(대분류)": "기타수입", "계정명": "이자수입", "성격": "INCOME", "결산서위치": "기타수입", "비고": "예금 이자"},
    {"구분(대분류)": "기타수입", "계정명": "잡이익", "성격": "INCOME", "결산서위치": "기타수입", "비고": ""},

    # --- 지출 (수지결산서) - 예산 관리 대상 ---
    {"구분(대분류)": "인건비", "계정명": "급여", "성격": "EXPENSE", "결산서위치": "인건비", "비고": ""},
    {"구분(대분류)": "인건비", "계정명": "상여금", "성격": "EXPENSE", "결산서위치": "인건비", "비고": ""},
    {"구분(대분류)": "인건비", "계정명": "복리후생비", "성격": "EXPENSE", "결산서위치": "인건비", "비고": "식대, 회식비 등"},
    {"구분(대분류)": "인건비", "계정명": "퇴직급여", "성격": "EXPENSE", "결산서위치": "인건비", "비고": "실제 지급액"},
    {"구분(대분류)": "인건비", "계정명": "4대보험", "성격": "EXPENSE", "결산서위치": "인건비", "비고": "회사 부담분"},
    
    {"구분(대분류)": "운영비", "계정명": "여비교통비", "성격": "EXPENSE", "결산서위치": "운영비", "비고": "출장비, 교통비"},
    {"구분(대분류)": "운영비", "계정명": "통신비", "성격": "EXPENSE", "결산서위치": "운영비", "비고": "전화, 인터넷, 우편"},
    {"구분(대분류)": "운영비", "계정명": "수도광열비", "성격": "EXPENSE", "결산서위치": "운영비", "비고": "관리비"},
    {"구분(대분류)": "운영비", "계정명": "세금과공과", "성격": "EXPENSE", "결산서위치": "운영비", "비고": ""},
    {"구분(대분류)": "운영비", "계정명": "지급임차료", "성격": "EXPENSE", "결산서위치": "운영비", "비고": "사무실 월세"},
    {"구분(대분류)": "운영비", "계정명": "수선비", "성격": "EXPENSE", "결산서위치": "운영비", "비고": ""},
    {"구분(대분류)": "운영비", "계정명": "도서인쇄비", "성격": "EXPENSE", "결산서위치": "운영비", "비고": ""},
    {"구분(대분류)": "운영비", "계정명": "소모품비", "성격": "EXPENSE", "결산서위치": "운영비", "비고": "사무용품 등"},
    {"구분(대분류)": "운영비", "계정명": "지급수수료", "성격": "EXPENSE", "결산서위치": "운영비", "비고": "세무기장료 등"},
    
    {"구분(대분류)": "사업비", "계정명": "회의비", "성격": "EXPENSE", "결산서위치": "사업비", "비고": "이사회, 총회 등"},
    {"구분(대분류)": "사업비", "계정명": "행사비", "성격": "EXPENSE", "결산서위치": "사업비", "비고": "워크숍, 세미나"},
    
    {"구분(대분류)": "영업외비용", "계정명": "감가상각비", "성격": "EXPENSE", "결산서위치": "비현금지출", "비고": "결산시 자동계산"},
])

# 2. [시트2] 회원사 목록 (Members)
# - 수입명세서(붙임_연회비 세부내역)에 있는 회사들을 미리 넣었습니다.
df_members = pd.DataFrame([
    {"회원사명": "금융결제원", "사업자번호": "", "담당자": "", "연락처": ""},
    {"회원사명": "나이스정보통신", "사업자번호": "", "담당자": "", "연락처": ""},
    {"회원사명": "나이스페이먼츠", "사업자번호": "", "담당자": "", "연락처": ""},
    {"회원사명": "다우데이타", "사업자번호": "", "담당자": "", "연락처": ""},
    {"회원사명": "스마트로", "사업자번호": "", "담당자": "", "연락처": ""},
    {"회원사명": "엔에이치앤케이씨피", "사업자번호": "", "담당자": "", "연락처": ""},
    {"회원사명": "케이에스넷", "사업자번호": "", "담당자": "", "연락처": ""},
    {"회원사명": "코밴", "사업자번호": "", "담당자": "", "연락처": ""},
    {"회원사명": "KIS정보통신", "사업자번호": "", "담당자": "", "연락처": ""},
    {"회원사명": "한국결제네트웍스", "사업자번호": "", "담당자": "", "연락처": ""},
    {"회원사명": "한국신용카드결제", "사업자번호": "", "담당자": "", "연락처": ""},
    {"회원사명": "한국정보통신", "사업자번호": "", "담당자": "", "연락처": ""},
])

# 3. [시트3] 고정자산 대장 (Fixed Assets)
# - 감가상각 계산을 위해 현재 보유 중인 자산을 입력하는 시트입니다.
df_assets = pd.DataFrame([
    {"자산명": "업무용 노트북(예시)", "취득일자": "2024-01-01", "취득가액": 1500000, "내용연수(년)": 5, "비고": "홍길동 사용"},
    {"자산명": "QVAN 소프트웨어", "취득일자": "2021-01-01", "취득가액": 214500000, "내용연수(년)": 5, "비고": "무형자산"},
    {"자산명": "사무실 집기비품", "취득일자": "2021-01-01", "취득가액": 3871040, "내용연수(년)": 5, "비고": "책상, 의자 등"},
])

# 4. [시트4] 2025년도 예산안 (Budget 2025)
# - 보내주신 PDF 내용에 맞춰 예산액을 확정짓는 시트입니다.
# - '계정명'은 반드시 [시트1]에 있는 이름과 똑같이 써야 합니다.
df_budget = pd.DataFrame([
    {"구분(대분류)": "인건비", "계정명": "급여", "연간예산액": 174380000, "비고": ""},
    {"구분(대분류)": "인건비", "계정명": "퇴직급여충당금전입액", "연간예산액": 16278000, "비고": ""},
    {"구분(대분류)": "인건비", "계정명": "4대보험", "연간예산액": 15100000, "비고": ""},
    {"구분(대분류)": "운영비", "계정명": "지급임차료", "연간예산액": 31800000, "비고": ""},
    {"구분(대분류)": "운영비", "계정명": "통신비", "연간예산액": 2280000, "비고": ""},
    {"구분(대분류)": "운영비", "계정명": "여비교통비", "연간예산액": 3300000, "비고": ""},
    # ... 나머지 항목들은 사용자가 엑셀에서 추가 입력 ...
])

# 엑셀 파일로 저장
with pd.ExcelWriter('finance_setup_template.xlsx', engine='openpyxl') as writer:
    df_accounts.to_excel(writer, sheet_name='1.계정과목_마스터', index=False)
    df_members.to_excel(writer, sheet_name='2.회원사_목록', index=False)
    df_assets.to_excel(writer, sheet_name='3.고정자산_대장', index=False)
    df_budget.to_excel(writer, sheet_name='4.2025_예산안', index=False)

print("✅ 'finance_setup_template.xlsx' 파일이 생성되었습니다.")
print("이 파일을 열어서 내용을 수정/보완한 뒤 개발자에게 전달해주세요.")